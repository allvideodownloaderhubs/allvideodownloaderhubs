import React, { useState, useEffect } from 'react';

// Main App Component
const App = () => {
    const [videoUrl, setVideoUrl] = useState('');
    const [downloadOptions, setDownloadOptions] = useState(null);
    const [error, setError] = useState('');
    const [isSidebarOpen, setIsSidebarOpen] = useState(false);

    // Function to validate URL
    const isValidUrl = (url) => {
        try {
            new URL(url);
            return true;
        } catch (e) {
            return false;
        }
    };

    // Handle form submission
    const handleDownload = (e) => {
        e.preventDefault();
        setError('');
        setDownloadOptions(null);

        if (!videoUrl) {
            setError('Please enter a video URL.');
            return;
        }

        if (!isValidUrl(videoUrl)) {
            setError('Please enter a valid URL.');
            return;
        }

        // Simulate API call for download options
        // In a real application, this would be a fetch call to your PHP backend
        // e.g., fetch('/api/get-download-options.php', { method: 'POST', body: JSON.stringify({ url: videoUrl }) })
        // .then(response => response.json())
        // .then(data => setDownloadOptions(data))
        // .catch(err => setError('Failed to get download options.'));

        // Simulating success:
        setTimeout(() => {
            setDownloadOptions([
                { quality: '1080p', format: 'MP4', size: '150MB', link: '#' },
                { quality: '720p', format: 'MP4', size: '80MB', link: '#' },
                { quality: '480p', format: 'MP4', size: '40MB', link: '#' },
                { quality: '360p', format: 'MP4', size: '25MB', link: '#' },
                { quality: 'MP3', format: 'Audio', size: '5MB', link: '#' },
            ]);
        }, 1000);
    };

    // Toggle sidebar visibility
    const toggleSidebar = () => {
        setIsSidebarOpen(!isSidebarOpen);
    };

    useEffect(() => {
        // Close sidebar on larger screens if it was open
        const handleResize = () => {
            if (window.innerWidth >= 768) { // Bootstrap's md breakpoint
                setIsSidebarOpen(false);
            }
        };
        window.addEventListener('resize', handleResize);
        return () => window.removeEventListener('resize', handleResize);
    }, []);

    return (
        <div className="d-flex flex-column min-vh-100 app-container" style={{ fontFamily: 'Inter, sans-serif' }}>
            {/* Common Header Placeholder */}
            {/* In a real PHP application, you would include common_header.php here */}
            {/* For React, we'll build it directly */}
            <header className="bg-primary text-white py-3 shadow-lg header-custom">
                <div className="container d-flex justify-content-between align-items-center">
                    <h1 className="h3 mb-0">
                        <a href="/" className="text-white text-decoration-none site-title">allvideodownloaderhubs</a>
                    </h1>
                    <button className="btn btn-primary d-md-none menu-toggle-btn" onClick={toggleSidebar} aria-label="Toggle navigation">
                        <i className="fas fa-bars fa-lg"></i> {/* Font Awesome for menu icon */}
                    </button>
                </div>
            </header>

            <div className="d-flex flex-grow-1 main-content-wrapper">
                {/* Side Menu */}
                <nav className={`bg-light p-4 shadow-sm sidebar ${isSidebarOpen ? 'sidebar-open' : ''} d-flex flex-column`}>
                    <h5 className="mb-4 text-primary sidebar-title">Tools & Navigation</h5>
                    <ul className="nav flex-column sidebar-nav-list">
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fas fa-video me-2"></i>YouTube Downloader
                            </a>
                        </li>
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fab fa-facebook me-2"></i>Facebook Downloader
                            </a>
                        </li>
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fab fa-tiktok me-2"></i>TikTok Downloader
                            </a>
                        </li>
                        {/* New: Pinterest Downloader */}
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fab fa-pinterest me-2"></i>Pinterest Downloader
                            </a>
                        </li>
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fas fa-link me-2"></i>Other Platforms
                            </a>
                        </li>
                        <li className="nav-item border-top pt-3 mt-3 mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fas fa-info-circle me-2"></i>About Us
                            </a>
                        </li>
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fas fa-envelope me-2"></i>Contact
                            </a>
                        </li>
                        <li className="nav-item mb-2">
                            <a href="#" className="nav-link text-dark rounded-pill py-2 px-3 sidebar-nav-link">
                                <i className="fas fa-shield-alt me-2"></i>Privacy Policy
                            </a>
                        </li>
                    </ul>
                </nav>

                {/* Main Content Area */}
                <main className="flex-grow-1 p-4 bg-light-subtle main-content-area">
                    <div className="container">
                        <h2 className="text-center text-primary mb-5 main-title">Download Videos from Any Platform!</h2>

                        <div className="card shadow-lg p-4 mb-5 rounded-4 border-0 download-card">
                            <div className="card-body">
                                <form onSubmit={handleDownload}>
                                    <div className="mb-4">
                                        <label htmlFor="videoUrl" className="form-label fs-5 text-dark input-label">
                                            Enter Video URL:
                                        </label>
                                        <input
                                            type="text"
                                            className={`form-control form-control-lg rounded-pill px-4 py-3 input-field ${error ? 'is-invalid' : ''}`}
                                            id="videoUrl"
                                            placeholder="e.g., https://www.youtube.com/watch?v=example"
                                            value={videoUrl}
                                            onChange={(e) => setVideoUrl(e.target.value)}
                                            aria-describedby="urlValidationFeedback"
                                        />
                                        {error && (
                                            <div id="urlValidationFeedback" className="invalid-feedback">
                                                {error}
                                            </div>
                                        )}
                                    </div>
                                    <div className="d-grid gap-2">
                                        <button type="submit" className="btn btn-primary btn-lg rounded-pill shadow-sm py-3 download-btn">
                                            <i className="fas fa-download me-2"></i> Download Video
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        {downloadOptions && (
                            <div className="card shadow-lg p-4 mb-5 rounded-4 border-0 options-card">
                                <div className="card-body">
                                    <h3 className="card-title text-primary mb-4 text-center options-title">Available Download Options</h3>
                                    <div className="table-responsive">
                                        <table className="table table-hover align-middle download-table">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Quality</th>
                                                    <th scope="col">Format</th>
                                                    <th scope="col">Size</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {downloadOptions.map((option, index) => (
                                                    <tr key={index}>
                                                        <td>{option.quality}</td>
                                                        <td>{option.format}</td>
                                                        <td>{option.size}</td>
                                                        <td>
                                                            <a href={option.link} className="btn btn-success btn-sm rounded-pill px-3 download-link-btn" download>
                                                                Download
                                                            </a>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Ads Management Placeholder */}
                        {/* In a real PHP application, you would include ads.php here */}
                        <div className="card bg-warning-subtle text-warning-emphasis p-4 text-center rounded-4 shadow-sm ad-area-card">
                            <h4 className="mb-3 ad-title">Advertisement Area</h4>
                            <p className="mb-0 ad-text">This is where your ads will be displayed. Integrate `ads.php` here.</p>
                            <div className="ad-box bg-white p-3 mt-3 rounded-3 border border-warning ad-placeholder-box">
                                <img src="https://placehold.co/728x90/FFD700/000000?text=Your+Ad+Here" alt="Ad Placeholder" className="img-fluid rounded ad-image" />
                            </div>
                        </div>
                    </div>
                </main>
            </div>

            {/* Common Footer Placeholder */}
            {/* In a real PHP application, you would include common_footer.php here */}
            {/* For React, we'll build it directly */}
            <footer className="bg-dark text-white py-4 mt-auto shadow-lg footer-custom">
                <div className="container text-center">
                    <p className="mb-2 footer-text">Â© {new Date().getFullYear()} allvideodownloaderhubs. All rights reserved.</p>
                    <ul className="list-inline mb-0 footer-links">
                        <li className="list-inline-item"><a href="#" className="text-white text-decoration-none hover-text-primary footer-link">Terms of Service</a></li>
                        <li className="list-inline-item">|</li>
                        <li className="list-inline-item"><a href="#" className="text-white text-decoration-none hover-text-primary footer-link">Privacy Policy</a></li>
                    </ul>
                </div>
            </footer>

            {/* Custom Styles */}
            <style>{`
                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

                :root {
                    --primary-color: #007bff; /* Original Bootstrap primary */
                    --primary-dark: #0056b3;
                    --primary-light: #e0f2ff; /* Lighter shade for hover */
                    --accent-color: #28a745; /* Success green */
                    --accent-dark: #218838;
                    --text-dark: #343a40;
                    --text-light: #f8f9fa;
                    --bg-light: #f8f9fa;
                    --bg-subtle: #e9ecef; /* A slightly darker light background */
                    --card-bg: #ffffff;
                    --shadow-light: rgba(0, 0, 0, 0.1);
                    --shadow-medium: rgba(0, 0, 0, 0.15);
                    --shadow-strong: rgba(0, 0, 0, 0.2);
                }

                body {
                    font-family: 'Inter', sans-serif;
                    background-color: var(--bg-subtle); /* More attractive background */
                    color: var(--text-dark);
                }

                /* General Enhancements */
                .app-container {
                    background: linear-gradient(to bottom right, #f0f2f5, #e0e5ec); /* Subtle gradient background */
                }

                /* Header */
                .header-custom {
                    background: linear-gradient(to right, #007bff, #0056b3); /* Gradient for header */
                    box-shadow: 0 4px 15px var(--shadow-medium);
                    position: sticky;
                    top: 0;
                    z-index: 1020; /* Above sidebar on scroll */
                }
                .site-title {
                    font-weight: 700;
                    letter-spacing: 0.5px;
                    transition: transform 0.2s ease-in-out;
                }
                .site-title:hover {
                    transform: scale(1.02);
                }
                .menu-toggle-btn {
                    border: none;
                    background-color: transparent !important;
                    color: white !important;
                    font-size: 1.2rem;
                    transition: transform 0.2s ease-in-out;
                }
                .menu-toggle-btn:hover {
                    transform: scale(1.1);
                }

                /* Side Menu */
                .sidebar {
                    background-color: var(--card-bg) !important;
                    border-right: 1px solid #e0e0e0;
                    box-shadow: 2px 0 10px var(--shadow-light);
                    padding-top: 2rem !important;
                    padding-bottom: 2rem !important;
                    transition: transform 0.3s ease-in-out, box-shadow 0.3s ease;
                }
                .sidebar-title {
                    font-weight: 600;
                    color: var(--primary-dark);
                    margin-bottom: 1.5rem !important;
                }
                .sidebar-nav-list .nav-item {
                    margin-bottom: 0.75rem !important;
                }
                .sidebar-nav-link {
                    color: var(--text-dark) !important;
                    font-weight: 500;
                    transition: all 0.2s ease;
                    border-radius: 0.5rem !important; /* Softer rounded corners */
                }
                .sidebar-nav-link:hover {
                    background-color: var(--primary-light) !important;
                    color: var(--primary-dark) !important;
                    transform: translateX(5px);
                }
                .sidebar-nav-link i {
                    width: 20px; /* Align icons */
                    text-align: center;
                }

                @media (max-width: 767.98px) {
                    .sidebar {
                        box-shadow: 5px 0 15px var(--shadow-medium);
                        padding-top: 5rem !important; /* Adjust for fixed header */
                    }
                }

                /* Main Content Area */
                .main-content-area {
                    padding: 2.5rem !important;
                }
                .main-title {
                    font-weight: 700;
                    color: var(--primary-dark);
                    text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
                }

                /* Cards */
                .download-card, .options-card, .ad-area-card {
                    background-color: var(--card-bg);
                    border-radius: 1.25rem !important; /* Even larger rounded corners */
                    box-shadow: 0 8px 30px var(--shadow-light);
                    transition: transform 0.3s ease, box-shadow 0.3s ease;
                }
                .download-card:hover, .options-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 12px 40px var(--shadow-medium);
                }

                /* Input Field */
                .input-field {
                    border: 2px solid var(--primary-light);
                    box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
                    transition: all 0.3s ease;
                    font-size: 1.1rem;
                }
                .input-field:focus {
                    border-color: var(--primary-color);
                    box-shadow: 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
                    background-color: #fff;
                }
                .input-label {
                    font-weight: 600;
                }

                /* Buttons */
                .download-btn {
                    background: linear-gradient(to right, var(--primary-color), var(--primary-dark));
                    border: none;
                    font-weight: 600;
                    letter-spacing: 0.5px;
                    transition: all 0.3s ease;
                    box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3);
                }
                .download-btn:hover {
                    background: linear-gradient(to right, var(--primary-dark), #003c7a);
                    transform: translateY(-3px) scale(1.01);
                    box-shadow: 0 6px 15px rgba(0, 123, 255, 0.4);
                }
                .download-btn:active {
                    transform: translateY(0);
                    box-shadow: 0 2px 5px rgba(0, 123, 255, 0.2);
                }

                .download-link-btn {
                    background-color: var(--accent-color);
                    border: none;
                    font-weight: 500;
                    transition: all 0.2s ease;
                }
                .download-link-btn:hover {
                    background-color: var(--accent-dark);
                    transform: translateY(-1px);
                }

                /* Table */
                .download-table thead th {
                    background-color: var(--primary-color);
                    color: white;
                    font-weight: 600;
                    border-bottom: none;
                }
                .download-table tbody tr {
                    transition: background-color 0.2s ease;
                }
                .download-table tbody tr:nth-child(even) {
                    background-color: #f2f2f2; /* Zebra striping */
                }
                .download-table tbody tr:hover {
                    background-color: var(--primary-light);
                }

                /* Ad Area */
                .ad-area-card {
                    background-color: #fff3cd !important; /* Warning light */
                    border: 1px solid #ffeeba !important; /* Warning border */
                    box-shadow: 0 4px 10px rgba(255, 193, 7, 0.2);
                }
                .ad-title {
                    color: #856404; /* Warning dark text */
                    font-weight: 600;
                }
                .ad-text {
                    color: #856404;
                }
                .ad-placeholder-box {
                    border: 2px dashed #ffc107 !important; /* Dashed warning border */
                }

                /* Footer */
                .footer-custom {
                    background: linear-gradient(to right, #343a40, #212529); /* Darker gradient for footer */
                    box-shadow: 0 -4px 15px var(--shadow-medium);
                }
                .footer-text {
                    font-size: 0.9rem;
                    color: rgba(255,255,255,0.8);
                }
                .footer-links .list-inline-item a {
                    font-size: 0.9rem;
                    color: rgba(255,255,255,0.8);
                    transition: color 0.2s ease;
                }
                .footer-links .list-inline-item a:hover {
                    color: var(--primary-color) !important;
                }
            `}</style>
            {/* Bootstrap CDN */}
            <link
                rel="stylesheet"
                href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
                xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
                crossOrigin="anonymous"
            />
            {/* Font Awesome for icons */}
            <link
                rel="stylesheet"
                href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
                xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
                crossOrigin="anonymous"
                referrerPolicy="no-referrer"
            />
        </div>
    );
};

export default App;
